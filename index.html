<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic Subscription Links</title>
    <!-- Inter Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for icons and specific elements not covered by Tailwind */
        body {
            font-family: 'Inter', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        /* Ensure icons have a fixed size to prevent distortion */
        .icon {
            width: 24px;
            height: 24px;
            color: #4f46e5; /* Accent color for icons */
            flex-shrink: 0; /* Prevent icons from shrinking */
        }
        .flag {
            font-size: 1.5rem;
            line-height: 1;
            flex-shrink: 0; /* Prevent flags from shrinking */
        }
        /* Specific Tailwind-like color classes for protocol tags */
        .bg-sky-100 { background-color: #e0f2fe; } .text-sky-800 { color: #075985; }
        .bg-emerald-100 { background-color: #d1fae5; } .text-emerald-800 { color: #065f46; }
        .bg-blue-100 { background-color: #dbeafe; } .text-blue-800 { color: #1e40af; }
        .bg-red-100 { background-color: #fee2e2; } .text-red-800 { color: #991b1b; }
        .bg-purple-100 { background-color: #f3e8ff; } .text-purple-800 { color: #6b21a8; }
        .bg-pink-100 { background-color: #fce7f3; } .text-pink-800 { color: #9d174d; }
        .bg-yellow-100 { background-color: #fef9c3; } .text-yellow-800 { color: #854d0e; }
        .bg-slate-200 { background-color: #e2e8f0; } .text-slate-800 { color: #1e293b; }
    </style>
</head>
<body class="bg-slate-50 text-slate-900 leading-relaxed">
    <div class="container max-w-6xl mx-auto px-4 py-8">
        <header class="text-center mb-10">
            <h1 class="text-3xl sm:text-4xl font-bold tracking-tight mb-0">Dynamic Subscription Links</h1>
            <p class="text-base sm:text-lg text-slate-500 mt-2">Select your preferences to get the corresponding subscription link and QR code.</p>
        </header>

        <main>
            <div class="bg-white rounded-xl p-6 sm:p-8 shadow-lg border border-slate-200 mb-8 sm:mb-10">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 sm:gap-6 mb-6">
                    <!-- Config Type Selection -->
                    <div>
                        <label for="configType" class="block text-sm font-medium text-slate-700 mb-2">Config Type:</label>
                        <select id="configType" class="block w-full rounded-md border-slate-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2.5 bg-slate-100">
                            <option value="">Select Config Type</option>
                        </select>
                    </div>

                    <!-- IP Type Selection -->
                    <div>
                        <label for="ipType" class="block text-sm font-medium text-slate-700 mb-2">IP Type:</label>
                        <select id="ipType" class="block w-full rounded-md border-slate-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2.5 bg-slate-100" disabled>
                            <option value="">Select IP Type</option>
                        </select>
                    </div>

                    <!-- Other Elements Selection -->
                    <div>
                        <label for="otherElement" class="block text-sm font-medium text-slate-700 mb-2">Other Elements:</label>
                        <select id="otherElement" class="block w-full rounded-md border-slate-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2.5 bg-slate-100" disabled>
                            <option value="">Select Element</option>
                        </select>
                    </div>
                </div>

                <!-- Display Area for URL and QR Code -->
                <div id="resultArea" class="hidden bg-slate-50 rounded-lg p-4 sm:p-6 border border-slate-200">
                    <h3 class="text-lg sm:text-xl font-semibold text-slate-800 mb-4">Your Subscription Link:</h3>
                    <div class="flex items-center mb-4">
                        <input type="text" id="subscriptionUrl" readonly
                            class="flex-grow font-mono text-xs sm:text-sm py-2 px-2.5 sm:py-2.5 sm:px-3 bg-white border border-slate-300 rounded-l-lg outline-none whitespace-nowrap overflow-hidden text-ellipsis" />
                        <button id="copyButton" class="flex-shrink-0 flex items-center justify-center w-10 h-10 sm:w-11 sm:h-11 bg-indigo-50 text-indigo-700 border border-indigo-600 rounded-r-lg cursor-pointer transition-colors duration-200 hover:bg-indigo-100" title="Copy URL">
                            <svg class='copy-icon w-4 h-4 sm:w-5 sm:h-5' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='currentColor'>
                                <path d='M7.5 3.375c0-1.036.84-1.875 1.875-1.875h.375a3.75 3.75 0 0 1 3.75 3.75v1.875C13.5 8.16 12.66 9 11.625 9h-.375a3.75 3.75 0 0 1-3.75-3.75V3.375ZM6.188 1.875a.75.75 0 0 0-1.5 0v1.875a.75.75 0 0 0 .75.75h.375a.75.75 0 0 0 .75-.75V5.25ZM9 3.375a2.25 2.25 0 0 1 2.25-2.25h.375a2.25 2.25 0 0 1 2.25 2.25v1.875a2.25 2.25 0 0 1-2.25 2.25h-.375A2.25 2.25 0 0 1 9 5.25V3.375Z' />
                                <path d='M12.983 9.917a.75.75 0 0 0-1.166-.825l-5.334 3.078a.75.75 0 0 0-.417.825V21a.75.75 0 0 0 .75.75h10.5a.75.75 0 0 0 .75-.75V13a.75.75 0 0 0-.417-.825l-5.333-3.078Z' />
                            </svg>
                            <svg class='check-icon w-4 h-4 sm:w-5 sm:h-5 hidden' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='currentColor'>
                                <path fill-rule='evenodd' d='M19.916 4.626a.75.75 0 0 1 .208 1.04l-9 13.5a.75.75 0 0 1-1.154.114l-6-6a.75.75 0 0 1 1.06-1.06l5.353 5.353 8.493-12.74a.75.75 0 0 1 1.04-.207Z' clip-rule='evenodd' />
                            </svg>
                        </button>
                    </div>
                    <div class="flex flex-col items-center justify-center">
                        <p class="text-sm text-slate-600 mb-2">Scan the QR code:</p>
                        <div id="qrcode" class="p-2 bg-white border border-slate-300 rounded-lg shadow-inner"></div>
                    </div>
                </div>
            </div>
        </main>

        <footer class="text-center mt-12 sm:mt-16 py-6 sm:py-8 border-t border-slate-200 text-slate-500 text-sm sm:text-base">
            <p>Generated by a dynamic subscription link tool. Use at your own risk.</p>
        </footer>
    </div>

    <!-- Message Box HTML -->
    <div id="messageBox" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 hidden">
        <div class="bg-white rounded-lg p-6 shadow-xl max-w-sm w-full text-center">
            <p id="messageBoxText" class="text-lg font-semibold text-slate-800 mb-4"></p>
            <button id="messageBoxClose" class="bg-indigo-600 text-white px-5 py-2 rounded-md hover:bg-indigo-700 transition-colors duration-200">OK</button>
        </div>
    </div>

    <!-- QR Code Library -->
    <script src="https://cdn.jsdelivr.net/npm/davidshimjs-qrcodejs@0.0.2/qrcode.min.js"></script>

    <script>
        // Data mapping for visuals
        const GITHUB_REPO_URL = 'https://raw.githubusercontent.com/itsyebekhe/PSG/main'; // This is still here for consistency, though PHP generates URLs

        const CLIENT_ICONS = {
            'clash': '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="icon"><path d="M12.75 3.03v.75a.75.75 0 0 1-1.5 0v-.75a.75.75 0 0 1 1.5 0Zm-1.5 8.25a.75.75 0 0 1 .75-.75h.75a.75.75 0 0 1 0 1.5h-.75a.75.75 0 0 1-.75-.75Zm-1.5 3a.75.75 0 0 1 .75-.75h.75a.75.75 0 0 1 0 1.5h-.75a.75.75 0 0 1-.75-.75ZM7.875 6a.75.75 0 0 1 .75-.75h.75a.75.75 0 0 1 0 1.5h-.75a.75.75 0 0 1-.75-.75ZM12 8.25a.75.75 0 0 1 .75-.75h.75a.75.75 0 0 1 0 1.5h-.75a.75.75 0 0 1-.75-.75Zm4.125-2.25a.75.75 0 0 1 .75-.75h.75a.75.75 0 0 1 0 1.5h-.75a.75.75 0 0 1-.75-.75ZM15 11.25a.75.75 0 0 1 .75-.75h.75a.75.75 0 0 1 0 1.5h-.75a.75.75 0 0 1-.75-.75ZM12.75 14.25a.75.75 0 0 1 .75-.75h.75a.75.75 0 0 1 0 1.5h-.75a.75.75 0 0 1-.75-.75ZM12 17.25a.75.75 0 0 1 .75-.75h.75a.75.75 0 0 1 0 1.5h-.75a.75.75 0 0 1-.75-.75ZM12.75 20.25a.75.75 0 0 1 .75-.75h.75a.75.75 0 0 1 0 1.5h-.75a.75.75 0 0 1-.75-.75ZM9.75 17.25a.75.75 0 0 1 .75-.75h.75a.75.75 0 0 1 0 1.5h-.75a.75.75 0 0 1-.75-.75ZM8.25 14.25a.75.75 0 0 1 .75-.75h.75a.75.75 0 0 1 0 1.5h-.75a.75.75 0 0 1-.75-.75ZM9 11.25a.75.75 0 0 1 .75-.75h.75a.75.75 0 0 1 0 1.5h-.75a.75.75 0 0 1-.75-.75Z M4.5 9a.75.75 0 0 1 .75-.75h.75a.75.75 0 0 1 0 1.5h-.75A.75.75 0 0 1 4.5 9Z" clip-rule="evenodd" />',
            'meta': '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="icon"><path d="M12.75 3.03v.75a.75.75 0 0 1-1.5 0v-.75a.75.75 0 0 1 1.5 0Zm-1.5 8.25a.75.75 0 0 1 .75-.75h.75a.75.75 0 0 1 0 1.5h-.75a.75.75 0 0 1-.75-.75Zm-1.5 3a.75.75 0 0 1 .75-.75h.75a.75.75 0 0 1 0 1.5h-.75a.75.75 0 0 1-.75-.75ZM7.875 6a.75.75 0 0 1 .75-.75h.75a.75.75 0 0 1 0 1.5h-.75a.75.75 0 0 1-.75-.75ZM12 8.25a.75.75 0 0 1 .75-.75h.75a.75.75 0 0 1 0 1.5h-.75a.75.75 0 0 1-.75-.75Zm4.125-2.25a.75.75 0 0 1 .75-.75h.75a.75.75 0 0 1 0 1.5h-.75a.75.75 0 0 1-.75-.75ZM15 11.25a.75.75 0 0 1 .75-.75h.75a.75.75 0 0 1 0 1.5h-.75a.75.75 0 0 1-.75-.75ZM12.75 14.25a.75.75 0 0 1 .75-.75h.75a.75.75 0 0 1 0 1.5h-.75a.75.75 0 0 1-.75-.75ZM12 17.25a.75.75 0 0 1 .75-.75h.75a.75.75 0 0 1 0 1.5h-.75a.75.75 0 0 1-.75-.75ZM12.75 20.25a.75.75 0 0 1 .75-.75h.75a.75.75 0 0 1 0 1.5h-.75a.75.75 0 0 1-.75-.75ZM9.75 17.25a.75.75 0 0 1 .75-.75h.75a.75.75 0 0 1 0 1.5h-.75a.75.75 0 0 1-.75-.75ZM8.25 14.25a.75.75 0 0 1 .75-.75h.75a.75.75 0 0 1 0 1.5h-.75a.75.75 0 0 1-.75-.75ZM9 11.25a.75.75 0 0 1 .75-.75h.75a.75.75 0 0 1 0 1.5h-.75a.75.75 0 0 1-.75-.75Z M4.5 9a.75.75 0 0 1 .75-.75h.75a.75.75 0 0 1 0 1.5h-.75A.75.75 0 0 1 4.5 9Z" clip-rule="evenodd" />',
            'singbox': '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="icon"><path fill-rule="evenodd" d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12Zm11.378-3.917c-.882 0-1.6.718-1.6 1.6 0 .882.718 1.6 1.6 1.6.882 0 1.6-.718 1.6-1.6 0-.882-.718-1.6-1.6-1.6ZM8.25 12c0-.882.718-1.6 1.6-1.6.882 0 1.6.718 1.6 1.6s-.718 1.6-1.6 1.6c-.882 0-1.6-.718-1.6-1.6Zm3.828 4.083c-1.61 0-2.917-1.306-2.917-2.917 0-1.61 1.307-2.917 2.917-2.917 1.61 0 2.917 1.307 2.917 2.917 0 1.61-1.307 2.917-2.917 2.917Z" clip-rule="evenodd" />',
            'surfboard': '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="icon"><path d="M14.625 2.25a.75.75 0 0 1 .75.75v18a.75.75 0 0 1-1.5 0V3a.75.75 0 0 1 .75-.75Z" /><path d="M5.969 4.22a.75.75 0 0 1 1.06 0l5.25 5.25a.75.75 0 0 1 0 1.06l-5.25 5.25a.75.75 0 1 1-1.06-1.06l4.72-4.72-4.72-4.72a.75.75 0 0 1 0-1.06Z" />',
            'warp': '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="icon"><path fill-rule="evenodd" d="M12.963 2.286a.75.75 0 0 0-1.071 1.052A9.75 9.75 0 0 1 18.635 12a.75.75 0 0 1-1.5 0 8.25 8.25 0 0 0-7.22-8.224.75.75 0 0 0-1.052-1.071Zm-3.182 2.859A.75.75 0 0 1 11.25 6a8.25 8.25 0 0 1 8.25 8.25.75.75 0 0 1-1.5 0A6.75 6.75 0 0 0 11.25 7.5a.75.75 0 0 1-.47-1.355Z" clip-rule="evenodd" />',
            'xray': '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="icon"><path d="M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25Zm1.823 12.34a.75.75 0 0 1-1.196-.935l.23-.46a.75.75 0 0 1 .936-1.196l-.23.46a.75.75 0 0 1 .266 1.631Zm-3.23.22a.75.75 0 0 1-1.197-.936l.231-.46a.75.75 0 0 1 .936-1.196l-.23.46a.75.75 0 0 1 .26 1.632Zm3.242-3.834a.75.75 0 0 1-1.061-1.06l.472-.472a.75.75 0 1 1 1.06 1.06l-.47.47Zm-3.415-3.415a.75.75 0 0 1-1.06-1.061l.47-.472a.75.75 0 1 1 1.06 1.06l-.47.472Z" />',
            'location': '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="icon"><path fill-rule="evenodd" d="M11.54 22.351l.07.04.028.016a.76.76 0 0 0 .723 0l.028-.015.071-.041a23.525 23.525 0 0 0 4.28-2.28.816.816 0 0 0-.001-1.442l-3.636-2.09A.75.75 0 0 0 12 16.5v-3.75a.75.75 0 0 1 .75-.75h.008a.75.75 0 0 0 .742-.723l.025-1.08a.75.75 0 0 0-.742-.777H12a.75.75 0 0 0-.75.75v5.25a.75.75 0 0 0 .44 1.33l3.182 1.836-2.923 1.68a21.998 21.998 0 0 1-2.613-1.63c-.22-.178-.484-.308-.758-.358V3a.75.75 0 0 1 .75-.75h2.25a.75.75 0 0 1 0 1.5H12v5.128a1.26 1.26 0 0 1 .099-.517l.01-.03a.75.75 0 0 1 .49-.495l1.023-.417a.75.75 0 0 0 .49-.495l.01-.03c.09-.236.19-.487.29-.728a.75.75 0 0 0-.25-1.011l-3.628-2.093a.818.818 0 0 0-1.444.001l-3.636 2.09A.75.75 0 0 0 4.5 5.25v3.75a.75.75 0 0 0 .75.75h.008a.75.75 0 0 1 .742.723l.025 1.08a.75.75 0 0 1-.742.777H6a.75.75 0 0 1-.75-.75V5.128c.09-.235.19-.486.29-.728a.75.75 0 0 1 .49-.495l1.024-.417a.75.75 0 0 0 .49-.495l.01-.03c.036-.089.07-.178.1-.266A.816.816 0 0 1 9.458 1.65L12 3.472l2.542-1.822a.818.818 0 0 1 1.444-.001l3.636 2.09a.75.75 0 0 1 .25 1.01l-.001.002c-.1.242-.2.493-.29.728l-.01.03a.75.75 0 0 0-.49.495l-1.023.417a.75.75 0 0 1-.49.495l-.01.03a1.26 1.26 0 0 1-.099.517V15a.75.75 0 0 1-.75.75h-2.25a.75.75 0 0 1 0-1.5H12V9.872c-.09.235-.19.486-.29.728a.75.75 0 0 1-.49.495l-1.024.417a.75.75 0 0 0-.49.495l-.01.03c-.09.236-.19.487-.29.728a.75.75 0 0 0 .25 1.011l3.628 2.093a.818.818 0 0 0 1.444-.001l3.636-2.09A.75.75 0 0 1 19.5 15V9.75a.75.75 0 0 1 .75-.75h.008a.75.75 0 0 0 .742-.723l.025-1.08a.75.75 0 0 0-.742-.777H20a.75.75 0 0 0-.75.75v5.25a.75.75 0 0 0 .44 1.33l3.182 1.836a2.25 2.25 0 0 1 .002 3.992l-4.281 2.28-4.28-2.28a.815.815 0 0 0-.724 0l-.028.015-.07.04Z" clip-rule="evenodd" />',
            'default' => '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="icon"><path fill-rule="evenodd" d="M11.998 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.383 2.25 11.998 2.25Zm.925 8.243a.75.75 0 0 0-1.85 0l-4.25 2.5a.75.75 0 0 0 .425 1.375l2.218-.475a.75.75 0 0 1 .633.262l1.75 2.5a.75.75 0 0 0 1.3-.913l-1.354-3.16a.75.75 0 0 1 .236-.904l3.013-2.125a.75.75 0 0 0-.5-1.312l-2.438.525a.75.75 0 0 1-.737-.55l-1-3.5a.75.75 0 0 0-1.424-.413l-1 3.5a.75.75 0 0 1-.737.55l-2.438-.525a.75.75 0 0 0-.5 1.312l3.013 2.125a.75.75 0 0 1 .236.904l-1.354 3.16a.75.75 0 0 0 1.3.913l1.75-2.5a.75.75 0 0 1 .633-.262l2.218.475a.75.75 0 0 0 .425-1.375l-4.25-2.5Z" clip-rule="evenodd" />',
        };

        const PROTOCOL_COLORS = {
            'vless': 'bg-sky-100 text-sky-800', 'reality': 'bg-emerald-100 text-emerald-800',
            'vmess': 'bg-blue-100 text-blue-800', 'trojan': 'bg-red-100 text-red-800',
            'ss': 'bg-purple-100 text-purple-800', 'hy2': 'bg-pink-100 text-pink-800',
            'tuic': 'bg-yellow-100 text-yellow-800', 'mix': 'bg-slate-200 text-slate-800',
        };

        // Dynamically injected structured data from PHP
        const structuredData = {
    "Lite": {
        "clash": {
            "ss": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/clash/ss",
            "mix": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/clash/mix",
            "trojan": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/clash/trojan",
            "vmess": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/clash/vmess"
        },
        "location": {
            "CA": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/location/normal/CA",
            "TR": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/location/normal/TR",
            "AM": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/location/normal/AM",
            "KZ": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/location/normal/KZ",
            "LK": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/location/normal/LK",
            "PH": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/location/normal/PH",
            "SG": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/location/normal/SG",
            "CN": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/location/normal/CN",
            "NL": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/location/normal/NL",
            "CH": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/location/normal/CH",
            "RU": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/location/normal/RU",
            "SE": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/location/normal/SE",
            "US": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/location/normal/US",
            "FR": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/location/normal/FR",
            "HU": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/location/normal/HU",
            "AT": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/location/normal/AT",
            "BR": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/location/normal/BR",
            "MT": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/location/normal/MT",
            "IT": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/location/normal/IT",
            "FI": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/location/normal/FI",
            "JP": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/location/normal/JP",
            "DE": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/location/normal/DE",
            "CY": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/location/normal/CY",
            "AU": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/location/normal/AU",
            "GB": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/location/normal/GB",
            "XX": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/location/normal/XX",
            "LT": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/location/normal/LT",
            "ID": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/location/normal/ID",
            "AE": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/location/normal/AE",
            "CZ": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/location/normal/CZ",
            "PL": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/location/normal/PL",
            "IE": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/location/normal/IE",
            "IR": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/location/normal/IR"
        },
        "meta": {
            "ss": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/meta/ss",
            "mix": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/meta/mix",
            "trojan": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/meta/trojan",
            "vless": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/meta/vless",
            "vmess": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/meta/vmess",
            "reality": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/meta/reality"
        },
        "surfboard": {
            "ss": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/surfboard/ss",
            "mix": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/surfboard/mix",
            "trojan": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/surfboard/trojan",
            "vmess": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/surfboard/vmess"
        },
        "xray": {
            "ss": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/xray/normal/ss",
            "reality_ipv4": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/xray/normal/reality_ipv4",
            "hy2": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/xray/normal/hy2",
            "reality_ipv6": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/xray/normal/reality_ipv6",
            "mix": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/xray/normal/mix",
            "hy2_domain": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/xray/normal/hy2_domain",
            "ss_domain": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/xray/normal/ss_domain",
            "vmess_domain": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/xray/normal/vmess_domain",
            "vless_ipv6": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/xray/normal/vless_ipv6",
            "trojan_ipv4": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/xray/normal/trojan_ipv4",
            "ss_ipv4": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/xray/normal/ss_ipv4",
            "ss_ipv6": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/xray/normal/ss_ipv6",
            "vless_domain": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/xray/normal/vless_domain",
            "trojan": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/xray/normal/trojan",
            "vless": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/xray/normal/vless",
            "vmess": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/xray/normal/vmess",
            "reality": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/xray/normal/reality",
            "vless_ipv4": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/xray/normal/vless_ipv4",
            "hy2_ipv4": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/xray/normal/hy2_ipv4",
            "tuic": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/xray/normal/tuic",
            "trojan_domain": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/xray/normal/trojan_domain",
            "reality_domain": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/lite/subscriptions/xray/normal/reality_domain"
        }
    },
    "Standard": {
        "clash": {
            "ss": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/clash/ss",
            "mix": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/clash/mix",
            "trojan": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/clash/trojan",
            "vmess": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/clash/vmess"
        },
        "location": {
            "RS": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/location/normal/RS",
            "UA": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/location/normal/UA",
            "LU": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/location/normal/LU",
            "LV": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/location/normal/LV",
            "CA": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/location/normal/CA",
            "IS": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/location/normal/IS",
            "TR": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/location/normal/TR",
            "CW": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/location/normal/CW",
            "AM": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/location/normal/AM",
            "KZ": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/location/normal/KZ",
            "LK": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/location/normal/LK",
            "KR": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/location/normal/KR",
            "PH": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/location/normal/PH",
            "SG": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/location/normal/SG",
            "CN": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/location/normal/CN",
            "NL": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/location/normal/NL",
            "CH": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/location/normal/CH",
            "RU": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/location/normal/RU",
            "IN": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/location/normal/IN",
            "SE": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/location/normal/SE",
            "US": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/location/normal/US",
            "FR": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/location/normal/FR",
            "HU": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/location/normal/HU",
            "MX": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/location/normal/MX",
            "PT": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/location/normal/PT",
            "AT": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/location/normal/AT",
            "BR": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/location/normal/BR",
            "MT": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/location/normal/MT",
            "IT": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/location/normal/IT",
            "HK": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/location/normal/HK",
            "FI": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/location/normal/FI",
            "JP": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/location/normal/JP",
            "DE": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/location/normal/DE",
            "CY": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/location/normal/CY",
            "AU": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/location/normal/AU",
            "GB": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/location/normal/GB",
            "XX": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/location/normal/XX",
            "ES": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/location/normal/ES",
            "LT": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/location/normal/LT",
            "ID": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/location/normal/ID",
            "AE": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/location/normal/AE",
            "BG": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/location/normal/BG",
            "NO": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/location/normal/NO",
            "CZ": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/location/normal/CZ",
            "PL": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/location/normal/PL",
            "IE": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/location/normal/IE",
            "IR": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/location/normal/IR"
        },
        "meta": {
            "ss": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/meta/ss",
            "mix": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/meta/mix",
            "trojan": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/meta/trojan",
            "vless": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/meta/vless",
            "vmess": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/meta/vmess",
            "reality": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/meta/reality"
        },
        "surfboard": {
            "ss": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/surfboard/ss",
            "mix": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/surfboard/mix",
            "trojan": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/surfboard/trojan",
            "vmess": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/surfboard/vmess"
        },
        "warp": {
            "config": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/warp/config"
        },
        "xray": {
            "ss": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/xray/normal/ss",
            "reality_ipv4": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/xray/normal/reality_ipv4",
            "hy2": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/xray/normal/hy2",
            "reality_ipv6": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/xray/normal/reality_ipv6",
            "mix": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/xray/normal/mix",
            "hy2_domain": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/xray/normal/hy2_domain",
            "ss_domain": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/xray/normal/ss_domain",
            "vmess_domain": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/xray/normal/vmess_domain",
            "vless_ipv6": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/xray/normal/vless_ipv6",
            "trojan_ipv4": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/xray/normal/trojan_ipv4",
            "tuic_ipv4": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/xray/normal/tuic_ipv4",
            "ss_ipv4": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/xray/normal/ss_ipv4",
            "ss_ipv6": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/xray/normal/ss_ipv6",
            "vless_domain": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/xray/normal/vless_domain",
            "trojan": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/xray/normal/trojan",
            "vless": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/xray/normal/vless",
            "vmess": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/xray/normal/vmess",
            "reality": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/xray/normal/reality",
            "vless_ipv4": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/xray/normal/vless_ipv4",
            "hy2_ipv4": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/xray/normal/hy2_ipv4",
            "tuic": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/xray/normal/tuic",
            "tuic_ipv6": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/xray/normal/tuic_ipv6",
            "trojan_domain": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/xray/normal/trojan_domain",
            "reality_domain": "https://raw.githubusercontent.com/itsyebekhe/PSG/main/subscriptions/xray/normal/reality_domain"
        }
    }
};

        // DOM elements
        const configTypeSelect = document.getElementById('configType');
        const ipTypeSelect = document.getElementById('ipType');
        const otherElementSelect = document.getElementById('otherElement');
        const resultArea = document.getElementById('resultArea');
        const subscriptionUrlInput = document.getElementById('subscriptionUrl');
        const copyButton = document.getElementById('copyButton');
        const qrcodeDiv = document.getElementById('qrcode');

        let qrcodeInstance = null; // To store the QR code instance

        // Function to show custom message box (replaces alert/confirm)
        function showMessageBox(message) {
            const messageBox = document.getElementById('messageBox');
            const messageBoxText = document.getElementById('messageBoxText');
            const messageBoxClose = document.getElementById('messageBoxClose');

            messageBoxText.textContent = message;
            messageBox.classList.remove('hidden');

            messageBoxClose.onclick = () => {
                messageBox.classList.add('hidden');
            };

            // Close if clicked outside the box
            messageBox.onclick = (e) => {
                if (e.target === messageBox) {
                    messageBox.classList.add('hidden');
                }
            };
        }

        /**
         * Populates a select element with options from an array or object keys.
         * @param {HTMLSelectElement} selectElement - The select element to populate.
         * @param {Array|Object} data - The data to use for options.
         * @param {string} defaultOptionText - The default text for the first option.
         * @param {boolean} disable - Whether to disable the select element after populating.
         */
        function populateSelect(selectElement, data, defaultOptionText, disable = false) {
            selectElement.innerHTML = `<option value=""></option>`;
            const keys = Array.isArray(data) ? data : Object.keys(data);
            keys.forEach(key => {
                const option = document.createElement('option');
                option.value = key;
                // Determine the 'type' for formatDisplayName based on the select element's ID
                let formatType = null;
                if (selectElement.id === 'ipType') {
                    // For ipType, the key itself is the type (e.g., 'clash', 'xray', 'location')
                    formatType = key;
                } else if (selectElement.id === 'otherElement' && ipTypeSelect.value === 'location') {
                    // If otherElement and ipType is 'location', then the key is a country code
                    formatType = 'location';
                } else if (selectElement.id === 'otherElement' && ipTypeSelect.value === 'xray') {
                    // If otherElement and ipType is 'xray', then the key is a protocol
                    formatType = 'xray';
                }
                option.textContent = formatDisplayName(key, formatType);
                selectElement.appendChild(option);
            });
            selectElement.disabled = disable;
        }

        /**
         * Formats the display name for options.
         * @param {string} name - The original name (e.g., 'us', 'vless', 'config1').
         * @param {string|null} type - The type of the element (e.g., 'location', 'xray') for specific formatting.
         * @returns {string} The formatted display name.
         */
        function formatDisplayName(name, type = null) {
            if (type === 'location') {
                return name.toUpperCase() + ' ' + getFlagEmoji(name); // For country codes, add flag
            } else if (type === 'xray') {
                return name.toUpperCase(); // For protocol names like vless, reality, mix
            }
            // Default formatting: Capitalize words, replace hyphens/underscores
            return name.split(/[-_]/).map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ');
        }

        /**
         * Generates a country flag emoji from a 2-letter country code.
         * @param {string} countryCode - The 2-letter ISO country code (e.g., "US", "DE").
         * @returns {string} The flag emoji or a default white flag if invalid.
         */
        function getFlagEmoji(countryCode) {
            if (typeof countryCode !== 'string' || countryCode.length !== 2 || !/^[A-Z]{2}$/.test(countryCode)) {
                return 'ðŸ³ï¸'; // White flag for invalid codes
            }
            const regionalOffset = 0x1F1E6 - 0x41; // Offset for regional indicator symbols
            const char1 = String.fromCodePoint(countryCode.charCodeAt(0) + regionalOffset);
            const char2 = String.fromCodePoint(countryCode.charCodeAt(1) + regionalOffset);
            return char1 + char2;
        }

        /**
         * Updates the QR code.
         * @param {string} url - The URL to encode in the QR code.
         */
        function updateQRCode(url) {
            qrcodeDiv.innerHTML = ''; // Clear previous QR code
            if (url) {
                // Initialize QRCode if not already
                if (!qrcodeInstance) {
                    qrcodeInstance = new QRCode(qrcodeDiv, {
                        text: url,
                        width: 128,
                        height: 128,
                        colorDark: "#000000",
                        colorLight: "#ffffff",
                        correctLevel: QRCode.CorrectLevel.H
                    });
                } else {
                    qrcodeInstance.makeCode(url); // Update existing QR code
                }
            }
        }

        // Event Listeners
        configTypeSelect.addEventListener('change', () => {
            const selectedConfigType = configTypeSelect.value;
            ipTypeSelect.value = ''; // Reset IP Type
            otherElementSelect.value = ''; // Reset Other Elements
            resultArea.classList.add('hidden'); // Hide result area

            if (selectedConfigType && structuredData[selectedConfigType]) {
                populateSelect(ipTypeSelect, structuredData[selectedConfigType], 'Select IP Type');
                otherElementSelect.disabled = true;
            } else {
                populateSelect(ipTypeSelect, [], 'Select IP Type', true); // Disable IP Type
                populateSelect(otherElementSelect, [], 'Select Element', true); // Disable Other Elements
            }
        });

        ipTypeSelect.addEventListener('change', () => {
            const selectedConfigType = configTypeSelect.value;
            const selectedIpType = ipTypeSelect.value;
            otherElementSelect.value = ''; // Reset Other Elements
            resultArea.classList.add('hidden'); // Hide result area

            if (selectedConfigType && selectedIpType && structuredData[selectedConfigType][selectedIpType]) {
                populateSelect(otherElementSelect, structuredData[selectedConfigType][selectedIpType], 'Select Element');
            } else {
                populateSelect(otherElementSelect, [], 'Select Element', true); // Disable Other Elements
            }
        });

        otherElementSelect.addEventListener('change', () => {
            const selectedConfigType = configTypeSelect.value;
            const selectedIpType = ipTypeSelect.value;
            const selectedOtherElement = otherElementSelect.value;

            if (selectedConfigType && selectedIpType && selectedOtherElement &&
                structuredData[selectedConfigType] &&
                structuredData[selectedConfigType][selectedIpType] &&
                structuredData[selectedConfigType][selectedIpType][selectedOtherElement]) {
                const url = structuredData[selectedConfigType][selectedIpType][selectedOtherElement];
                subscriptionUrlInput.value = url;
                updateQRCode(url);
                resultArea.classList.remove('hidden');
            } else {
                resultArea.classList.add('hidden');
                subscriptionUrlInput.value = '';
                updateQRCode(''); // Clear QR code
            }
        });

        copyButton.addEventListener('click', () => {
            const url = subscriptionUrlInput.value;
            if (url) {
                // Use document.execCommand('copy') as navigator.clipboard.writeText() might not work in some iframe environments
                const tempInput = document.createElement('textarea');
                tempInput.value = url;
                document.body.appendChild(tempInput);
                tempInput.select();
                try {
                    document.execCommand('copy');
                    const copyIcon = copyButton.querySelector('.copy-icon');
                    const checkIcon = copyButton.querySelector('.check-icon');
                    copyIcon.classList.add('hidden');
                    checkIcon.classList.remove('hidden');
                    setTimeout(() => {
                        copyIcon.classList.remove('hidden');
                        checkIcon.classList.add('hidden');
                    }, 2000);
                } catch (err) {
                    console.error('Failed to copy URL: ', err);
                    showMessageBox('Failed to copy URL. Please copy manually.');
                } finally {
                    document.body.removeChild(tempInput);
                }
            } else {
                showMessageBox('No URL to copy. Please select a subscription link first.');
            }
        });

        // Initialize the first dropdown on page load
        document.addEventListener('DOMContentLoaded', () => {
            populateSelect(configTypeSelect, structuredData, 'Select Config Type');
        });
    </script>
</body>
</html>